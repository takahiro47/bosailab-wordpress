extends _application
include _ui
//-
  The template for displaying Archive pages.

  Used to display archive-type pages if nothing more specific matches a query.
  For example, puts together date-based pages if no date.php file exists.

  If you'd like to further customize these archive views, you may create a
  new template file for each specific one. For example, Twenty Thirteen
  already has tag.php for Tag archives, category.php for Category archives,
  and author.php for Author archives.

  Learn more: http://codex.wordpress.org/Template_Hierarchy

  @package WordPress
  @subpackage SFC_Bosalab_2013
  @since 1.0

block page_article
  :php
    // クエリの生成
    $title = false;
    $param = array(
      'posts_per_page' => 200,
      'post_type' => get_post_type(),
      'post_status' => 'publish',
      'orderby' => 'date',
      'order' => 'DESC'
    );
    // クエリを実行して投稿を取得
    $wp_query = new WP_Query();
    $wp_query->query($param);

    // 投稿があった場合，投稿表示ループを開始
    if ( $wp_query->have_posts() ) {
      while ( $wp_query->have_posts() ) {
        $wp_query->the_post();

  <?php if (get_post_type() == 'project') { ?>
  :php
    $thumbnail_url = wp_get_attachment_url( get_post_thumbnail_id($post->ID), 'project-archive' );

  .col-sm-4.page-layer__media--project--archive
    .page-layer__media--project__cell
      .archive-media--project-wrap
        .archive-media--project
          .archive-media--photograph-wrap
            .archive-media--background
            a.js-navi-single(href!='<?php the_permalink(); ?>')
              .archive-media--photograph(style!="background-image:url('<?php echo $thumbnail_url; ?>');")
              .archive-media--photograph-shadow
              +ui-loader
          article.archive-media--project__article
            h3.archive-media--project-title.ellipsis
              a.js-navi-single(href!='<?php the_permalink(); ?>') <?php the_title(); ?>
            ul.archive-media--project-tags.ui-tags
              <?php $post_tags = get_the_tags(); if ($post_tags) { foreach($post_tags as $tag) { ?>
              li.tag <?php echo $tag->name; ?>
              <?php } } ?>
          footer.archive-media--project__footer
            .archive-media--project-year
              .starting-year <?php the_field( 'starting_year' ); ?>
              .separator -
              .end-year <?php the_field( 'end_year' ); ?>


  <?php } else if (get_post_type() == 'photolog') { ?>
  :php
    $thumbnail_url = get_field('photo')['sizes']['photolog-archive'];

  .page-layer__media--photolog--archive
    .page-layer__media--photolog__cell
      .archive-media--photolog-wrap
        .archive-media--photolog
          .archive-media--background
          .archive-media--photograph-wrap
            a.js-navi-single(href!='<?php the_permalink(); ?>')
              .archive-media--photograph(style!="background-image:url('<?php echo $thumbnail_url; ?>');")
              .archive-media--photograph-shadow
              +ui-loader
          header.archive-media--photolog__header
            .archive-media--photolog__date <?php echo toLastUpdateString( new DateTime( get_the_time('Y-m-d H:i:s') ) ), PHP_EOL; ?>
          article.archive-media--photolog__article
            h3.archive-media--photolog-title
              a.js-navi-single(href!='<?php the_permalink(); ?>') <?php the_title(); ?>
          footer.archive-media--photolog__footer
            .archive-media--photolog__views
              i.fa.fa-heart
              | <?php echo $post->pvc_views; ?>


  <?php } else if (get_post_type() == 'report') { ?>
  :php
    $thumbnail_url = wp_get_attachment_url( get_post_thumbnail_id($post->ID), 'report-archive' );

  .page-layer__media--report--archive
    .page-layer__media--report__cell
      .archive-media--report-wrap
        .archive-media--report
          .archive-media--photograph-wrap
            a.js-navi-single(href!='<?php the_permalink(); ?>')
              .archive-media--photograph(style!="background-image:url('<?php echo $thumbnail_url; ?>');")
              .archive-media--photograph-shadow
              +ui-loader
          header.archive-media--report__header
            .ui-calendar
              time <?php echo get_the_time('Y-m-d H:i:s'); ?>
              .date-icon
                .date-month <?php echo get_the_time('M'); ?>
                .date-day <?php echo get_the_time('d'); ?>
                .date-year <?php echo get_the_time('Y'); ?>
            .archive-media--report__relative-date
              | <?php echo toLastUpdateString( new DateTime( get_the_time('Y-m-d H:i:s') ) ), PHP_EOL; ?>
          article.archive-media--report__article
            h3.archive-media--report__title.ellipsis
              a.js-navi-single(href!='<?php the_permalink(); ?>') <?php the_title(); ?>
            p.archive-media--report__excerpt.ellipsis.multiline <?php echo new_excerpt(120); ?>


  <?php } else if (get_post_type() == 'paper') { ?>
  :php
    $thumbnail_url = wp_get_attachment_url( get_post_thumbnail_id($post->ID), 'paper-archive' );

  .page-layer__media--paper--archive
    .page-layer__media--paper__cell
      .archive-media--paper-wrap
        .archive-media--paper
          .archive-media--photograph-wrap
            .archive-media--background
            a.js-navi-single(href!='<?php the_permalink(); ?>')
              .archive-media--photograph(style!="background-image:url('<?php echo $thumbnail_url; ?>');")
              .archive-media--photograph-shadow
              +ui-loader
          article.archive-media--project__article
            h3.archive-media--project-title.ellipsis
              a.js-navi-single(href!='<?php the_permalink(); ?>') <?php the_title(); ?>
            ul.archive-media--project-tags.ui-tags
              <?php $post_tags = get_the_tags(); if ($post_tags) { foreach($post_tags as $tag) { ?>
              li.tag <?php echo $tag->name; ?>
              <?php } } ?>
          footer.archive-media--project__footer

  <?php } else { ?>


  <?php } ?>

  :php
    }} // 投稿表示ループここまで
